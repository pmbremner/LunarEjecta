(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16419,        419]
NotebookOptionsPosition[     14787,        387]
NotebookOutlinePosition[     15220,        403]
CellTagsIndexPosition[     15177,        400]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"e2", "[", 
   RowBox[{"v_", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"v", "^", "2"}]}], "-", "1"}], ")"}], "^", "2"}], "*", 
    RowBox[{
     RowBox[{"Sin", "[", "g", "]"}], "^", "2"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", "g", "]"}], "^", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ecosbp", "[", 
   RowBox[{"v_", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"2", "*", 
    RowBox[{"v", "^", "2"}], "*", 
    RowBox[{
     RowBox[{"Sin", "[", "g", "]"}], "^", "2"}]}], "-", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esinbp", "[", 
   RowBox[{"v_", ",", "g_"}], "]"}], ":=", 
  RowBox[{"2", "*", 
   RowBox[{"v", "^", "2"}], "*", 
   RowBox[{"Sin", "[", "g", "]"}], "*", 
   RowBox[{"Cos", "[", "g", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bpp", "[", 
   RowBox[{"v_", ",", "g_"}], "]"}], ":=", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{"ecosbp", "[", 
     RowBox[{"v", ",", "g"}], "]"}], ",", 
    RowBox[{"esinbp", "[", 
     RowBox[{"v", ",", "g"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ecosbs", "[", 
   RowBox[{"v_", ",", "g_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "/", "r"}], "*", 
    RowBox[{"v", "^", "2"}], "*", 
    RowBox[{
     RowBox[{"Sin", "[", "g", "]"}], "^", "2"}]}], "-", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esinbs", "[", 
   RowBox[{"v_", ",", "g_", ",", "r_", ",", "pm_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"pm", "/", "r"}], "*", 
   RowBox[{"esinbp", "[", 
    RowBox[{"v", ",", "g"}], "]"}], "*", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"Tan", "[", "g", "]"}], "^", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{"r", "-", "1"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"r", "-", 
        RowBox[{
         RowBox[{"v", "^", "2"}], "*", 
         RowBox[{"(", 
          RowBox[{"r", "+", "1"}], ")"}]}]}], ")"}]}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vp", "[", 
   RowBox[{"g_", ",", "r_", ",", "d_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", "r"}], "-", 
          RowBox[{"Cos", "[", "d", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"Cos", "[", "d", "]"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "*", "g"}], "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "*", "g"}], "]"}], "*", 
      RowBox[{"Cot", "[", 
       RowBox[{"d", "/", "2"}], "]"}]}]}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rs", "[", 
   RowBox[{"v_", ",", "g_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"2", "*", 
   RowBox[{"v", "^", "2"}], "*", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "g", "]"}], "^", "2"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "^", "2"}], "-", "1"}], ")"}], "*", 
       RowBox[{"Cos", "[", "d", "]"}]}], "-", 
      RowBox[{
       RowBox[{"v", "^", "2"}], "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"d", "-", 
         RowBox[{"2", "*", "g"}]}], "]"}]}]}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8588486089638343`*^9, 3.8588486347538586`*^9}, {
  3.8588486657934036`*^9, 3.8588487146229057`*^9}, {3.858848809089337*^9, 
  3.858848815237711*^9}, {3.8588488674904957`*^9, 3.858848896723672*^9}, {
  3.8588490101637344`*^9, 3.858849075407646*^9}, {3.858849680351198*^9, 
  3.8588497477428865`*^9}, {3.858850591327932*^9, 3.8588506135638285`*^9}, {
  3.8588507832656183`*^9, 3.858850847694549*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"b6b6c6d9-87de-42ff-ba1c-504ca7d834df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hh", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rr", "=", 
  RowBox[{"1", "+", "hh"}]}], "\[IndentingNewLine]", 
 RowBox[{"dd", "=", "0.6"}], "\[IndentingNewLine]", 
 RowBox[{"gg", "=", 
  RowBox[{
   RowBox[{"60.", "/", "180."}], "*", "Pi"}]}], "\[IndentingNewLine]", 
 RowBox[{"vpp", "=", 
  RowBox[{"vp", "[", 
   RowBox[{"gg", ",", "rr", ",", "dd"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rs", "[", 
  RowBox[{"vpp", ",", "gg", ",", "dd"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Mod", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"dd", "+", 
        RowBox[{"bpp", "[", 
         RowBox[{"vpp", ",", "gg"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sin", "[", 
       RowBox[{"dd", "+", 
        RowBox[{"bpp", "[", 
         RowBox[{"vpp", ",", "gg"}], "]"}]}], "]"}]}], "]"}], "-", 
    RowBox[{"bpp", "[", 
     RowBox[{"vpp", ",", "gg"}], "]"}]}], ",", 
   RowBox[{"2", "*", "Pi"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"2", "*", 
  RowBox[{"vpp", "^", "2"}], "*", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "gg", "]"}], "^", "2"}], "/", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"e2", "[", 
        RowBox[{"vpp", ",", "gg"}], "]"}], "]"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"dd", "+", 
        RowBox[{"bpp", "[", 
         RowBox[{"vpp", ",", "gg"}], "]"}]}], "]"}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.858849188811381*^9, 3.858849333846726*^9}, {
  3.858849381118976*^9, 3.858849474369652*^9}, {3.858849596002444*^9, 
  3.858849596403778*^9}, {3.858849750952799*^9, 3.85884990524391*^9}, {
  3.858849987971675*^9, 3.858850048515725*^9}, {3.858850565305928*^9, 
  3.8588505806414733`*^9}, {3.85885061889618*^9, 3.8588507554107275`*^9}, {
  3.85885085767787*^9, 3.858850889111636*^9}, {3.8588509610148587`*^9, 
  3.8588510025485053`*^9}, {3.8588511549303074`*^9, 3.858851184227398*^9}},
 CellLabel->
  "In[323]:=",ExpressionUUID->"9084f9e8-c075-44dc-b3ca-f4e8acc92fe5"],

Cell[BoxData["1.01`"], "Output",
 CellChangeTimes->{{3.8588492600196867`*^9, 3.858849265427438*^9}, {
   3.8588493157236195`*^9, 3.8588493345329165`*^9}, {3.8588493823920417`*^9, 
   3.8588494052654195`*^9}, {3.858849455008773*^9, 3.8588494751253767`*^9}, 
   3.8588495971061172`*^9, {3.8588497734250355`*^9, 3.8588498092828455`*^9}, 
   3.858849849509616*^9, {3.8588498840594225`*^9, 3.858849905723339*^9}, {
   3.8588499891912303`*^9, 3.8588500490330715`*^9}, {3.8588506289349775`*^9, 
   3.8588507558809896`*^9}, {3.858850864199142*^9, 3.858850889327948*^9}, {
   3.858850961500742*^9, 3.858851003435811*^9}, 3.8588511854628243`*^9},
 CellLabel->
  "Out[324]=",ExpressionUUID->"3986657b-db3a-44f0-b437-0db59d7772e1"],

Cell[BoxData["0.6`"], "Output",
 CellChangeTimes->{{3.8588492600196867`*^9, 3.858849265427438*^9}, {
   3.8588493157236195`*^9, 3.8588493345329165`*^9}, {3.8588493823920417`*^9, 
   3.8588494052654195`*^9}, {3.858849455008773*^9, 3.8588494751253767`*^9}, 
   3.8588495971061172`*^9, {3.8588497734250355`*^9, 3.8588498092828455`*^9}, 
   3.858849849509616*^9, {3.8588498840594225`*^9, 3.858849905723339*^9}, {
   3.8588499891912303`*^9, 3.8588500490330715`*^9}, {3.8588506289349775`*^9, 
   3.8588507558809896`*^9}, {3.858850864199142*^9, 3.858850889327948*^9}, {
   3.858850961500742*^9, 3.858851003435811*^9}, 3.8588511854628243`*^9},
 CellLabel->
  "Out[325]=",ExpressionUUID->"5dcc81f7-75f5-423e-8bc2-4ed06483e39a"],

Cell[BoxData["1.0471975511965979`"], "Output",
 CellChangeTimes->{{3.8588492600196867`*^9, 3.858849265427438*^9}, {
   3.8588493157236195`*^9, 3.8588493345329165`*^9}, {3.8588493823920417`*^9, 
   3.8588494052654195`*^9}, {3.858849455008773*^9, 3.8588494751253767`*^9}, 
   3.8588495971061172`*^9, {3.8588497734250355`*^9, 3.8588498092828455`*^9}, 
   3.858849849509616*^9, {3.8588498840594225`*^9, 3.858849905723339*^9}, {
   3.8588499891912303`*^9, 3.8588500490330715`*^9}, {3.8588506289349775`*^9, 
   3.8588507558809896`*^9}, {3.858850864199142*^9, 3.858850889327948*^9}, {
   3.858850961500742*^9, 3.858851003435811*^9}, 3.8588511854628243`*^9},
 CellLabel->
  "Out[326]=",ExpressionUUID->"3c6d2ac8-c879-4dc1-ba78-194f2133c701"],

Cell[BoxData["0.5770039454445461`"], "Output",
 CellChangeTimes->{{3.8588492600196867`*^9, 3.858849265427438*^9}, {
   3.8588493157236195`*^9, 3.8588493345329165`*^9}, {3.8588493823920417`*^9, 
   3.8588494052654195`*^9}, {3.858849455008773*^9, 3.8588494751253767`*^9}, 
   3.8588495971061172`*^9, {3.8588497734250355`*^9, 3.8588498092828455`*^9}, 
   3.858849849509616*^9, {3.8588498840594225`*^9, 3.858849905723339*^9}, {
   3.8588499891912303`*^9, 3.8588500490330715`*^9}, {3.8588506289349775`*^9, 
   3.8588507558809896`*^9}, {3.858850864199142*^9, 3.858850889327948*^9}, {
   3.858850961500742*^9, 3.858851003435811*^9}, 3.8588511854784474`*^9},
 CellLabel->
  "Out[327]=",ExpressionUUID->"99fe4bad-8376-4ef4-b5d5-d9b2693c0de9"],

Cell[BoxData["1.1777351038229071`"], "Output",
 CellChangeTimes->{{3.8588492600196867`*^9, 3.858849265427438*^9}, {
   3.8588493157236195`*^9, 3.8588493345329165`*^9}, {3.8588493823920417`*^9, 
   3.8588494052654195`*^9}, {3.858849455008773*^9, 3.8588494751253767`*^9}, 
   3.8588495971061172`*^9, {3.8588497734250355`*^9, 3.8588498092828455`*^9}, 
   3.858849849509616*^9, {3.8588498840594225`*^9, 3.858849905723339*^9}, {
   3.8588499891912303`*^9, 3.8588500490330715`*^9}, {3.8588506289349775`*^9, 
   3.8588507558809896`*^9}, {3.858850864199142*^9, 3.858850889327948*^9}, {
   3.858850961500742*^9, 3.858851003435811*^9}, 3.8588511854784474`*^9},
 CellLabel->
  "Out[328]=",ExpressionUUID->"31c9be16-02fa-47e7-8cf8-6e49cd426d16"],

Cell[BoxData["0.5999999999999996`"], "Output",
 CellChangeTimes->{{3.8588492600196867`*^9, 3.858849265427438*^9}, {
   3.8588493157236195`*^9, 3.8588493345329165`*^9}, {3.8588493823920417`*^9, 
   3.8588494052654195`*^9}, {3.858849455008773*^9, 3.8588494751253767`*^9}, 
   3.8588495971061172`*^9, {3.8588497734250355`*^9, 3.8588498092828455`*^9}, 
   3.858849849509616*^9, {3.8588498840594225`*^9, 3.858849905723339*^9}, {
   3.8588499891912303`*^9, 3.8588500490330715`*^9}, {3.8588506289349775`*^9, 
   3.8588507558809896`*^9}, {3.858850864199142*^9, 3.858850889327948*^9}, {
   3.858850961500742*^9, 3.858851003435811*^9}, 3.8588511854784474`*^9},
 CellLabel->
  "Out[329]=",ExpressionUUID->"03891d50-d8cf-478a-b203-54872a9ab7d8"],

Cell[BoxData["1.1777351038229071`"], "Output",
 CellChangeTimes->{{3.8588492600196867`*^9, 3.858849265427438*^9}, {
   3.8588493157236195`*^9, 3.8588493345329165`*^9}, {3.8588493823920417`*^9, 
   3.8588494052654195`*^9}, {3.858849455008773*^9, 3.8588494751253767`*^9}, 
   3.8588495971061172`*^9, {3.8588497734250355`*^9, 3.8588498092828455`*^9}, 
   3.858849849509616*^9, {3.8588498840594225`*^9, 3.858849905723339*^9}, {
   3.8588499891912303`*^9, 3.8588500490330715`*^9}, {3.8588506289349775`*^9, 
   3.8588507558809896`*^9}, {3.858850864199142*^9, 3.858850889327948*^9}, {
   3.858850961500742*^9, 3.858851003435811*^9}, 3.8588511854784474`*^9},
 CellLabel->
  "Out[330]=",ExpressionUUID->"4c196176-519e-48c7-8b63-3c9eaf734455"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"e2", "[", 
      RowBox[{"v", ",", "g"}], "]"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"v", "^", "2"}]}], ")"}]}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.858851047996217*^9, 3.858851095332939*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"9f71be9d-8eba-4342-bbb2-f19f1c4fb83a"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SuperscriptBox["v", "2"], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", "g", "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.858851056301956*^9, 3.858851095611786*^9}},
 CellLabel->
  "Out[322]=",ExpressionUUID->"a155f24c-5087-46d5-8dca-b2911a8ca71c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"v", "==", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", "r"}], "-", 
             RowBox[{"Cos", "[", "d", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Cos", "[", "d", "]"}]}], ")"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", "*", "g"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", "*", "g"}], "]"}], "*", 
         RowBox[{"Cot", "[", 
          RowBox[{"d", "/", "2"}], "]"}]}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ",", "r"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.858851229837675*^9, 3.8588512465217915`*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"0756a740-288e-4c77-bcea-d45c1e899dea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"r", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["v", "2"], " ", 
      RowBox[{"Cos", "[", "d", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "g", "]"}], "2"]}], 
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["v", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "d", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "g", "]"}], "2"]}], "-", 
         RowBox[{
          RowBox[{"Cot", "[", 
           FractionBox["d", "2"], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "g"}], "]"}]}]}], ")"}]}]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.858851239453068*^9, 3.8588512476312084`*^9}},
 CellLabel->
  "Out[332]=",ExpressionUUID->"8ec66451-c651-4cd0-b020-c1e4c2f317fc"]
}, Open  ]]
},
WindowSize->{913.8, 465.59999999999997`},
WindowMargins->{{Automatic, 108}, {39.60000000000002, Automatic}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"47705b9d-0785-4ba7-a80a-56dd91a1d4fe"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4067, 126, 166, "Input",ExpressionUUID->"b6b6c6d9-87de-42ff-ba1c-504ca7d834df"],
Cell[CellGroupData[{
Cell[4650, 150, 2120, 54, 185, "Input",ExpressionUUID->"9084f9e8-c075-44dc-b3ca-f4e8acc92fe5"],
Cell[6773, 206, 719, 10, 32, "Output",ExpressionUUID->"3986657b-db3a-44f0-b437-0db59d7772e1"],
Cell[7495, 218, 718, 10, 32, "Output",ExpressionUUID->"5dcc81f7-75f5-423e-8bc2-4ed06483e39a"],
Cell[8216, 230, 733, 10, 32, "Output",ExpressionUUID->"3c6d2ac8-c879-4dc1-ba78-194f2133c701"],
Cell[8952, 242, 733, 10, 32, "Output",ExpressionUUID->"99fe4bad-8376-4ef4-b5d5-d9b2693c0de9"],
Cell[9688, 254, 733, 10, 32, "Output",ExpressionUUID->"31c9be16-02fa-47e7-8cf8-6e49cd426d16"],
Cell[10424, 266, 733, 10, 32, "Output",ExpressionUUID->"03891d50-d8cf-478a-b203-54872a9ab7d8"],
Cell[11160, 278, 733, 10, 32, "Output",ExpressionUUID->"4c196176-519e-48c7-8b63-3c9eaf734455"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11930, 293, 475, 14, 28, "Input",ExpressionUUID->"9f71be9d-8eba-4342-bbb2-f19f1c4fb83a"],
Cell[12408, 309, 288, 7, 32, "Output",ExpressionUUID->"a155f24c-5087-46d5-8dca-b2911a8ca71c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12733, 321, 1095, 33, 28, "Input",ExpressionUUID->"0756a740-288e-4c77-bcea-d45c1e899dea"],
Cell[13831, 356, 940, 28, 109, "Output",ExpressionUUID->"8ec66451-c651-4cd0-b020-c1e4c2f317fc"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

